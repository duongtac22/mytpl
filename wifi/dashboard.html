<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="libs/slick/slick.css" />
    <link rel="stylesheet" href="libs/slick/slick-theme.css">
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body>
    <style>
                    .chartWrapper {
            position: relative;
            
        }

        .chartWrapper > canvas {
            position: absolute;
            left: 0;
            top: 0;
            pointer-events:none;
        }
.chartAreaWrapper {
          overflow-x: scroll;
            position: relative;
            width: 100%;
        }

        .chartAreaWrapper2 {
          
            position: relative;
            height: 300px;
        }

    </style>
    <div id="app">
      <div class="page-quanly page-tongquan">
        <div class="fixed-sidebar">
          <a href="javascript:;" class="sidebar-logo">
            <img src="images/logo-bizfly-wifi.png" alt="" />
          </a>

          <ul class="sidebar-menu top">
            <li class="sidebar-menu-item">
              <a href="javascript:;">
                <img src="images/ic-tongquan.png" alt="" />
                Tổng quan
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="javascript:;">
                <img src="images/ic-login.png" alt="" />
                Hình thức đăng nhập
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="javascript:;">
                <img src="images/ic-settings.png" alt="" />
                Cài đặt Router
              </a>
            </li>
          </ul>

          <ul class="sidebar-menu bottom">
            <li class="sidebar-menu-item">
              <a href="javascript:;">
                <i class="fal fa-info-circle"></i>
                Hướng dẫn sử dụng
              </a>
            </li>
            <li class="sidebar-menu-item">
              <a href="javascript:;">
                <i class="fal fa-question-circle"></i>
                Trợ giúp
              </a>
            </li>
          </ul>
        </div>

        <div class="quanly-main">
          <div class="fixed-header">
            <div class="header-top-right float-right d-flex align-items-center">
              <div class="dropdown dropdown mr-3">
                <a href="/" class="notification">
                  <img
                    src="../../images/bizfly-ic-bell.png"
                    alt=""
                    class="noti-ic"
                  />
                </a>
              </div>
              <div class="dropdown info d-flex align-items-center">
                <a class="" href="#">
                  <img
                    src="../../images/bizfly-login-ava.png"
                    alt=""
                    class="avatar"
                  />
                </a>
              </div>
            </div>
          </div>

          <div class="quanly-content">

            <div class="row">
                <div class="col-12 col-lg-8">
                    <div class="page-title">
                        <h1 class="page-title">Tổng quan</h1>
                    </div>
                </div>

                <div class="col-12 col-lg-4 d-flex flex-wrap align-items-center">
                    <div class="custom-select2 select-router"><select id="routerList" class="form-control" dir="rtl"><option value="" selected="selected"> Tất cả các Router</option> <option>1</option> <option>2</option> <option>3</option> <option>4</option> <option>5</option></select></div>
                    <div class="custom-select2 select-router-time"><select id="setupTime" class="form-control"><option value="" selected="selected"> 30 Ngày </option> <option>1</option> <option>2</option> <option>3</option> <option>4</option> <option>5</option></select></div>
                
                </div>

                <div class="col-12 col-md-6 col-lg-3">
                    <div class="dashboard-box">

                        <p> Tổng số lượt truy cập   <a href="" class="ml-1"> <i class="fal fa-info-circle"></i>  </a> </p>

                        <div class="dashboard-info">
                            
                            <div class="result">
                                <b> 2312 </b>
                            </div>
                            <div class="calculate">

                                <img src="images/ic-up.png" alt="">
                                <span> + 12% </span>

                            </div>
                        </div>

                        <span>
                            Truy cập trong 30 ngày gần nhất
                        </span>

                    </div>
                </div>

                <div class="col-12 col-md-6 col-lg-3">
                    <div class="dashboard-box">

                        <p>  Đang sử dụng <a href="" class="ml-1"> <i class="fal fa-info-circle"></i>  </a> </p>

                        <div class="dashboard-info">
                            
                            <div class="result">
                                <b> 2020 </b>
                            </div>
                            <div class="calculate">

                                <img src="images/ic-down.png" alt="">
                                <span> - 10% </span>
                                
                            </div>
                        </div>

                        <span>
                          Số lượt đăng nhập hiện tại
                        </span>

                    </div>
                </div>

                <div class="col-12 col-md-6 col-lg-3">
                    <div class="dashboard-box">

                    <p> Số khách mới   <a href="" class="ml-1"> <i class="fal fa-info-circle"></i>  </a> </p>

                    <div class="dashboard-info">
                        
                        <div class="result">
                            <b> 889 </b>
                        </div>
                        <div class="calculate">

                            <img src="images/ic-up.png" alt="">
                            <span> + 25% </span>
                            
                        </div>
                    </div>

                    <span>
                        Khách mới trong 30 ngày gần nhất
                    </span>

                    </div>
                </div>
                <div class="col-12 col-md-6 col-lg-3">
                  <div class="dashboard-box">

                  <p> Số khách mới   <a href="" class="ml-1"> <i class="fal fa-info-circle"></i>  </a> </p>

                  <div class="dashboard-info">
                      
                      <div class="result">
                          <b> 889 </b>
                      </div>
                      <div class="calculate">

                          <img src="images/ic-up.png" alt="">
                          <span> + 25% </span>
                          
                      </div>
                  </div>

                  <span>
                      Khách mới trong 30 ngày gần nhất
                  </span>

                  </div>
                </div>
            </div>

            <div class="row chart-js">
              <div class="col-12 col-lg-8">
                <div class="dashboard-box">
                    <p> Biểu đồ tổng số lượt truy cập </p>
                    <div class="chart">
                      <div class="card-body">
                          
                          <p>
                            <b> Số lượt </b>
                          </p>

                          <div class="chartWrapper">
                            <div class="chartAreaWrapper">
                              <div class="chartjs-holder">
                                <canvas id="areaChart_1" class="chartjs-render-monitor" height="300" width="1200"></canvas>
                              </div>
                              
                            </div>
                            <canvas id="myChartAxis" height="300" width="0"></canvas>
                        </div>
                        
                          
                      </div>
                    </div>
                    <!-- 
                    <div class="online d-flex align-items-center flex-wrap mb-3">
                        <i class="fas fa-circle color-green"></i>
                        <b class="current-online"> 45 </b>
                        <span class="mt-0"> phiên đang truy cập </span>
                    </div>

                    <div class="table-responsive">
                        <table class="current-device w-100 ">
                            <thead>
                                <tr>
                                    <th>
                                        <input type="checkbox" class="custom-checkbox">
                                    </th>
                                    <th>
                                        Trạng thái
                                    </th>
                                    <th>
                                        Tên Thiết bị
                                    </th>
                                    <th class="text-right">
                                        Thời gian hoạt động
                                    </th>
                                    <th>
                                        Địa chỉ IP
                                    </th>
                                    <th>
                                        Địa chỉ MAC
                                    </th>
                                </tr>
                            </thead>

                            <tbody>
                                <tr>
                                    <td width="26">
                                        <input type="checkbox" class="custom-checkbox">
                                    </td>
                                    <td width="80">
                                        Allowed
                                    </td>
                                    <td>
                                        Iphone X
                                    </td>
                                    <td class="text-right" width="150">
                                        00:32:44
                                    </td>
                                    <td class="text-left" width="150">
                                        192.168.2.1
                                    </td>
                                    <td width="150">
                                        00:1B:44:11:3A:B7
                                    </td>
                                </tr>
                                <tr>
                                    <td width="26">
                                        <input type="checkbox" class="custom-checkbox">
                                    </td>
                                    <td width="80">
                                        Allowed
                                    </td>
                                    <td>
                                        Iphone X
                                    </td>
                                    <td class="text-right" width="150">
                                        00:32:44
                                    </td>
                                    <td class="text-left" width="150">
                                        192.168.2.1
                                    </td>
                                    <td width="150">
                                        00:1B:44:11:3A:B7
                                    </td>
                                </tr>
                                <tr>
                                    <td width="26">
                                        <input type="checkbox" class="custom-checkbox">
                                    </td>
                                    <td width="80">
                                        Allowed
                                    </td>
                                    <td>
                                        Iphone X
                                    </td>
                                    <td class="text-right" width="150">
                                        00:32:44
                                    </td>
                                    <td class="text-left" width="150">
                                        192.168.2.1
                                    </td>
                                    <td width="150">
                                        00:1B:44:11:3A:B7
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div> -->
                </div>
            </div>


            <div class="col-12 col-lg-4">
                <div class="dashboard-box">
                    <p>  Loại thiết bị truy cập </p>

                    <div class="chart">
                        <canvas id="myChart" width="256" height="256"></canvas>
                    </div>


                    <div class="chart-label">

                        <div class="chart-label-name">
                            <i class="fas fa-circle color-green"></i>
                            <span> Mobile </span>
                        </div>
                        <div class="chart-label-name">
                            <i class="fas fa-circle color-purple"></i>
                            <span> Table </span>
                        </div>
                        <div class="chart-label-name">
                            <i class="fas fa-circle color-orange"></i>
                            <span> Laptop/PC </span>
                        </div>
                    </div>

                </div>
            </div>
            </div>

            <p class="copyright-dashboard text-right">
              <b>
                BizFly. All rights reserved.
© Copyright 2020
              </b>
            </p>
          </div>
          
        </div>
      </div>
    </div>


    <script
      src="https://code.jquery.com/jquery-3.5.1.js"
      integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
      crossorigin="anonymous"
    ></script>
    <script src="js/vue.js"></script>
    <script src="js/httpVueLoader.js"></script>
    <script src="libs/bootstrap/bootstrap.min.js"></script>
    <script src="libs/bootstrap/popper.min.js"></script>
    <script src="libs/slick/slick.min.js"></script>

    <!-- chartjs de ve bieu do-->
    <script src="libs/chartjs/Chart.js"></script>

    <script src="js/main.js"></script>
    <script>
      var app = new Vue({
        el: "#app",
        data: {
          limit : 30 , 
          chart_test : {
            label : [],
            datasets : [{
              label : 'test data aalskdajldks',
              data : []
            }]
          } ,
        },
        methods : {

          checkChart : function(dataChart, holder, limit) {

            console.log(dataChart);

            let countData = parseInt(dataChart.datasets[0].data.length) ;

          }


        } ,

        // computed : {
          
        //   fakeLabels : function() {
        //     var chartLabels = [];
        //     for (x = 0; x < this.limit ; x++) {
        //         chartLabels.push("Label" + x);
        //     }
        //     return this.chart_test.label = chartLabels ;
        //   }, 

        //   fakeDataset : function() {
        //     var chartData = [] ;
        //     for (x = 0; x < this.limit ; x++) {
        //       chartData.push(Math.floor((Math.random() * 100) + 1));
        //     }

        //     return this.chart_test.datasets[0].data =  chartData ;
        //   }, 


        // },
        mounted() {
          this.$nextTick(function () {

            // open preview
            RunFn.showPopup('.js-open-preview');

            // // close button
            // RunFn.showPopup('.js-open-preview');

            // hover
            $(".quanly-item").hover(function () {
              $(this).find(".quanly-item-wrap").toggleClass("hover");
            });

            $(".js-steps-slider").slick();

            var areaChart0 = function(){	
                //pie area chart
                if($('#myChart').length > 0 ){
                  const areaChart_0 = document.getElementById("myChart").getContext('2d');

                  new Chart(areaChart_0, {
                type: "pie",
                data: {
                    datasets: [{
                        data: [ 13, 3, 30],
                        backgroundColor: ['#FF9500',
                        '#AF52DE',
                        '#34C759'],
                        label: "Dataset 1"
                    }],
                    labels: ["Red", "Orange", "Yellow"]
                    },
                    options: {
                      tooltips: {
                          // enabled: false,
                          backgroundColor : '#fff' ,
                          bodyFontColor: "#333333", 
                          bodyAlign : 'center' , 
                         custom: function(tooltip) {
                            if (!tooltip) return;
                            // disable displaying the color box;
                            tooltip.displayColors = false;
                          },
                          callbacks: {
                            title: function(tooltipItem, data) {
                              //return data['labels'][tooltipItem[0]['index']];

                            },
                           
                            label: function(tooltipItem, data) {
                              var dataset = data['datasets'][0];
                              var percent = Math.round((dataset['data'][tooltipItem['index']] / dataset["_meta"][0]['total']) * 100);
                              return percent; 
                            },
                            afterLabel: function(tooltipItem, data) {
                              return '~ ' + data['datasets'][0]['data'][tooltipItem['index']] + ' lượt ' ; 
                            },
                            
                          }
                        },
                        legend: {
                            display: false,
                        } ,
                        responsive:true,
                        maintainAspectRatio: false
                    }
                  });
                }
              } ;
            

            // custom chart 
            function fakeLabels(limit) {
                var chartLabels = [];
                for (x = 0; x < limit; x++) {
                  chartLabels.push("Label" + x);
                }
                return chartLabels;
              }

            function fakeDataset(limit) {
                var chartData = [];
                for (x = 0; x < limit; x++) {
                  chartData.push(Math.floor(Math.random() * 100 + 1));
                }
                return chartData;
              }


            const areaChart_1 = document.getElementById("areaChart_1").getContext('2d');

            var gradientBg = areaChart_1.createLinearGradient(0,0,0,300);


            gradientBg.addColorStop(1,"rgba(255, 255, 255, 0)");

            gradientBg.addColorStop(0.4,"rgba(0, 122, 255, 0.5)");

            gradientBg.addColorStop(0,"rgba(0, 122, 255, 0.33)");

            var newChartData = [];
            var chartDataleft =  [] ;

            var chart1_data = {
              labels: fakeLabels(30),
              datasets: [
                {
                  label: "Biểu đồ tổng số lượt truy cập",

                  // > 30 label thi scroll x 
                  data : fakeDataset(30),
                  borderColor: '#007AFF',
                  borderWidth: "1",
                  // fillColor : gradientBg,
                  backgroundColor: gradientBg,
                }
              ]
            } ;


            // 50 data
            var areaChart1 = function(){	
                //basic area chart



                    var chartTest = new Chart(areaChart_1, {
                    type: 'line',
                    data: chart1_data ,
                    options: {
                      legend: false, 
                      maintainAspectRatio: false,
                      responsive: true,
                      elements: {
                      point:{
                              radius: 0
                          }
                      } ,
                      scales: {
                        yAxes: [{
                          ticks: {
                            max: 100, 
                            min: 0, 
                            stepSize: 20, 
                            padding: 5,
                            fontSize: 12,
                          },
                          gridLines: {
                            display: false,
                          },
                        }],
                        xAxes: [{ 
                          ticks: {
                            padding: 5,
                            fontSize: 12,
                          }
                        }]
                      },

                      animation: {
                          onComplete: function(animation) {
                            var scale = window.devicePixelRatio; 
                                // alert('onAnimationComplete')

                                // thay doi width canvas 

                                let countData = parseInt(chart1_data.datasets[0].data.length);

                                console.log(animation);

                                  // tao yAxes fake khi scroll
                                  var sourceCanvas = this.chart.ctx.canvas;
                                  var copyWidth = this.scales['y-axis-0'].width - 10;
                                  console.log(copyWidth);
                                  var copyHeight = this.scales['y-axis-0'].height + this.scales['y-axis-0'].top + 10;
                                  console.log(copyHeight);
                                  var targetCtx = document.getElementById("myChartAxis").getContext("2d");
                                  targetCtx.canvas.width = copyWidth;
                                  targetCtx.drawImage(sourceCanvas, 0, 0, copyWidth * scale, copyHeight * scale, 0, 0, copyWidth * scale, copyHeight * scale);


                                  var sourceCtx = sourceCanvas.getContext('2d');
                                  sourceCtx.clearRect(0, 0, copyWidth * scale, copyHeight * scale);

                            },
                          onProgress: function () {
                                var copyWidth = this.scales['y-axis-0'].width;
                                var copyHeight = this.scales['y-axis-0'].height + this.scales['y-axis-0'].top + 10;

                                var sourceCtx = chartTest.chart.canvas.getContext('2d');
                                sourceCtx.clearRect(0, 0, copyWidth, copyHeight);
                          }
                        }
                    }
                  });

                // tinh lai width cho canvas 
                
                // 50 , max 30, > 30 scroll 
                // => [30]  [ophan con lai] 
                let dataLeft = 20 ;


                for (var i = 0; i < dataLeft; i++) {

                  chartTest.data.datasets[0].data.push(Math.random() * 100);
                  chartTest.data.labels.push("Test" + i );

                  var newwidth = $('.chartjs-holder').width() + 60;

                  $('.chartjs-holder').width(newwidth);

                }

                
              } ;
              
            areaChart0();
            areaChart1();
            


            $(window).on('resize',function(){
              areaChart0();
              // areaChart1();
  
            })
          });
        },
      });
    </script>
  </body>
</html>
